---
title: "Gun Deaths in the United States, 2019"
author: "Carson Duce"
date: '`r Sys.Date()`'
output: html_document
---
## Background
In a time of politically charged debates surrounding the topic of the 2nd Amendment to the US Constitution, both sides with their arguments often stretch and bend the present data to fit their message. Generalizing, the two sides we currently see are gun control advocates (GCA) and the 2nd Amendment Advocates (2AA). The GCA aim to reduce gun violence by enacting red flag laws, require a federal universal background check of which to ensure that only law abiding citizens in good mental health have access to firearms and its accessories. The 2AA aim to allow firearm ownership to be practiced by law abiding citizens as is stated by the 2nd Amendment to the United States Constitution. 

The 2nd Amendment reads: "A well regulated militia, being necessary to the security of a free State, the right of the people to keep and bear Arms, shall not be infringed." 

When looking at the history of the United States, the word choice of the 2nd Amendment, and the its time in history, many arguments are formed based on different interpretations of who the 2nd Amendment applies to. *GCA arguments point out that the words like "regulated," "militia," and "security of a free State," offer reason to believe that the 2nd Amendment refers to a State's ability to form a militia, and regulate it to the States liking; of which the National Guards gets cited, a collective entity.* 2AA arguments goes down the road that the 2nd Amendment targets the individual specifically and that an armed individual (one), and a group of armed individuals (many) make up a militia. Different points get brought up regarding the other Amendments that show up in the Bill of Rights. 2AA highlight an exercise that taking out the 2nd Amendment from the Bill of Rights and then re-reading the Bill of Rights show that all other Amendments attain to the individual citizen (Wilson Combat, 2022). The Supreme Court has heard cases surrounding this very debate in Heller vs. District of Columbia in 2008. 

To provide a brief background on the case, DC made it illegal to carry unregistered firearms, and also prohibited registration of handguns (unless through the chief of police issuing a license of which could be denied). Laws were put in placed that required registered firearms to be unloaded, disassembled, bound to a trigger lock to be rendered inoperable unless in a form of business or legal recreation. Heller worked as a special police officer that carried a handgun on duty but was denied by the chief of police when Heller went to apply for a license. After which, Heller sued DC arguing that they had "violated his Second Amendment right to keep a function firearm in his home without a license" (Oyez). After hearing arguments in court, the Supreme Court Justices came to a 5 - 4 majority in declaring the DC's laws surrounding the permitting process and storage laws violated the 2nd Amendment. Justice Antonin Scalia would give the opinion of the court in a lengthy manner characterizing the history that the Amendment was written in, and how its current implementations relate to today.  

The conclusion that the majority came to held onto the individual notion of the citizen being able to keep and bear arms, not the military. A main reasoning was since it "...would be to create exactly the type of state-sponsored force against which the Amendment was meant to protect people" (Oyez). 

When looking at the States legal code, many different states have different laws when it comes to using deadly force (force that can lead to the physical harm or death of a person) during self defense. The three main classifications that states tend to portray themselves are Duty to Retreat, Castle Doctrine, or Stand Your Ground language in their legal code. The same definition provided here will be the same definitions displayed on the finished maps in the "Results" section of this report. Duty to retreat has language that states that a person who is under an imminent threat of personal harm must make a reasonable effort to avoid confrontation; de-escalation or leave the area of the threat. Stand your ground has language that allows armed individuals who believe they are in imminent danger to uyse deadly force without first attempting to retreat from the danger. Castle Doctrine has language which is similar to stand your grtound and it typically limimted to a home, property, and in some states, cars. The concept that an indiviudal has a right to be safe/secure within his/her home (castle) and should not ahve to retreat from home in order to be safe. 

## Data
This project derived its data from the Gun Violence Archive (GVA), an independent research and data collection organization. GVA utilizing various autonomous data collection methods that collects from "...7,500+ sources from local and state police, media, data aggregates, government and other sources daily" (Gun Violence Archive, 2022). Utilizing processes of verifying reports through an initial researcher, and another secondary validation system, the GVA organization seeks to provide accurate and readily accessible data to further the discussion on gun violence (Gun Violence Archive, 2022). Collecting data was simple through GVA's website, https://www.gunviolencearchive.org/, that saw a query search option for its records. 

### Data Acquisition
This portion highlights step by step instructions of what parameters were utilized in the query search of GVA, the process of using R: A language and environment for statistical computing for working with the data to create a comma separated value (CSV) file to then be used for geocoding in ESRI's ArcGIS Pro.  

#### 1: Query Search
When in the GVA's website, searching the database can be found here: https://www.gunviolencearchive.org/query. Starting off with the default settings, click "Add a rule" to enable the first parameter to be applied. Using the scroll bar, scroll to where "Guns" appear and select it. Within the "Guns" rule, select the middle box to be (if its not already) "contains" and select the third box to be whichever class of firearms one may desire. Select "Add a rule" again and select "Date." Within the "Date" rule, be sure the middle box is set to "is in" and the "From" and "To" box are set to the desired range (see image 1.0).

![Image 1.0: GVA Query Search](https://raw.githubusercontent.com/Duceman56/2019MappingOfGunArchive/main/pictures/image1%2C0.JPG)

When ready with all parameters entered, select "Save" to pull up the results. During query searching, GVA's website limits query search's to a maximum of 80 pages for each search (see image 1.1 for example). The date range may need to be reconfigured to ensure that all records are being gathered. When it has been determined that the query search has been successful, select "Export as CSV" to save the file in a comma seperated file format. Good file labeling helps with this step. 

![Image 1.1: Last page of search, notice when "last" is selected we only get to page 68](https://raw.githubusercontent.com/Duceman56/2019MappingOfGunArchive/main/pictures/image1%2C1Example.JPG)

For this project, all three class of firearms were query searched for. Rifle and shotgun saw all incidents combined into their own seperate CSV file; one file for rifle and one file for shotgun. Incidents involving handguns would require six separate CSV files for all to be accounted for properly. Image 1.2 shows the naming convention of the separate CSV files.

![Image 1.2: Naming Conventions](https://raw.githubusercontent.com/Duceman56/2019MappingOfGunArchive/main/pictures/image1%2C2FileNaming.JPG)

After all CSV files have been downloaded and loaded into a known folder somewhere, open up RStudio. 

#### 2: Loading data into RStudio 
Loading data will take place in the form of scripting and storing the CSV file as a data frame inside RStudio. Utilizing the package "readr", this package will give us the ability to read and write to files in a neater fashion.

```{r, echo = F}
knitr::opts_chunk$set(message = F, warning = F)
```

```{r}
library(readr) ## used to read in and write to a csv file

```

The following code shows what variables the CSV files are being stored into. The file path used in this example is from the Github repository, 2019MappingOfGunArchive found here in the data folder: https://github.com/Duceman56/2019MappingOfGunArchive. The file path can also be a folder path on ones Windows or MacOS machine.  
```{r}
handgun1 <- read_csv("https://raw.githubusercontent.com/Duceman56/2019MappingOfGunArchive/main/data/GVADec2nd2019ThroughDec31st2019HandgunIncidents.csv")
handgun2 <- read_csv("https://raw.githubusercontent.com/Duceman56/2019MappingOfGunArchive/main/data/GVAJan1st2019ThroughMar1st2019HandgunIncidents.csv")
handgun3 <- read_csv("https://raw.githubusercontent.com/Duceman56/2019MappingOfGunArchive/main/data/GVAJul2nd2019ThroughSep1st2019HandgunIncidents.csv")
handgun4 <- read_csv("https://raw.githubusercontent.com/Duceman56/2019MappingOfGunArchive/main/data/GVAMar2nd2019ThroughMay1st2019HandgunIncidents.csv")
handgun5 <- read_csv("https://raw.githubusercontent.com/Duceman56/2019MappingOfGunArchive/main/data/GVAMay2nd2019ThroughJul1st2019HandgunIncidents.csv")
handgun6 <- read_csv("https://raw.githubusercontent.com/Duceman56/2019MappingOfGunArchive/main/data/GVASep2nd2019ThroughDec1st2019HandgunIncidents.csv")
rifle <- read_csv("https://raw.githubusercontent.com/Duceman56/2019MappingOfGunArchive/main/data/GVAJan1st2019ThroughDec31st2019RifleIncidents.csv")
shotgun <- read_csv("https://raw.githubusercontent.com/Duceman56/2019MappingOfGunArchive/main/data/GVAJan1stThroughDec31stShotgunIncidents.csv")

```


## Method
With the CSV files now loaded into working data frames, the objective is to create a new column that has the whole address on one line, and clean the data frames up to allow for all the handgun variables to be combined into one large "handgun" data frame to then be exported. After viewing each of the data frames, the main columns that will be preserved will be columns one through seven: 

```{r}
handgun1 <- handgun1[, 1:7]
handgun2 <- handgun2[, 1:7]
handgun3 <- handgun3[, 1:7]
handgun4 <- handgun4[, 1:7]
handgun5<- handgun5[, 1:7]
handgun6 <- handgun6[, 1:7]
rifle <- rifle[, 1:7]
shotgun <- shotgun[, 1:7]

```

Now that all the handgun variables have the same number of columns desired and includes only the wanted data, the following code will take all the handgun variables and produce the "handgun" data set:
```{r}
handgun <- rbind(handgun1, handgun2, handgun3, handgun4, handgun5, handgun6)

```

With the new "handgun" data set, the addresses where each incident took place at are separated into three separate columns, "Address," "City or County," and "State." The column "wholeAddress" is created that combines all three columns separated by a comma. Afterwards, we are required to force "wholeAddress" into being a temporary data frame called "handgunTemp":
```{r}
wholeAddress <- paste(handgun$Address, handgun$`City Or County`, handgun$State, sep = ", ")
handgunTemp <- as.data.frame(wholeAddress)

wholeAddressRifle <- paste(rifle$Address, rifle$`City Or County`, rifle$State, sep = ", ")
rifleTemp1 <- as.data.frame(wholeAddressRifle)

wholeAddressShotgun <- paste(shotgun$Address, shotgun$`City Or County`, shotgun$State, sep = ", ")
shotgunTemp1 <- as.data.frame(wholeAddressShotgun)
```

With each data frame now having their addresses in one column, combining the temporary data frame into the main data frame occurs: 
```{r}
handgun <- cbind(handgun, handgunTemp)
rifle <- cbind(rifle, rifleTemp1)
shotgun <- cbind(shotgun, shotgunTemp1)
```

Now that all the data frames are adequate to move forward, writing the new data frames to a separate CSV file takes place. The file path will need to be located someplace on ones computer: 
```{r, eval = F}
## for MacOS machines
write_csv(handgun, file = "//Users//carsond//Desktop//handgun.csv")
write_csv(rifle, file = "//Users//carsond//Desktop//rifle.csv")
write_csv(shotgun, file = "//Users//carsond//Desktop//shotgun.csv")

## for Window machines
write_csv(handgun, file = "Q://StudentCoursework//Zeitler//GEOG.280.001.2235//DUCECR1126//09 - Final Map Project//handgun.csv") 
write_csv(rifle, file = "Q://StudentCoursework//Zeitler//GEOG.280.001.2235//DUCECR1126//09 - Final Map Project//handgun.csv")
write_csv(shotgun, file = "Q://StudentCoursework//Zeitler//GEOG.280.001.2235//DUCECR1126//09 - Final Map Project//handgun.csv")
```

With our exported CSV files in a folder on our machine, open up ArcGIS Pro and sign in with your account. Create a new map project, name and store it in the same folder as the exported CSV files are located. Load up the main base map in ArcGIS Pro and within the "Analysis" tab, click "Tools" to open up the geoprocessing tools. In the search bar, type in "geocoding." Side note, this processing takes 40 credits per 1,000 addresses geocoded. When buying credits on ESRI's website, 1000 credits cost $120. When working with the geocoding tool, for "Input Table," click the yellow folder and find the first exported CSV file to be geocoded; click "OK." For "Input Address Locator, the default ESRI locator will be used. Click the yellow folder and find where it says "Project" on the left side of the window and click into the "Locators" folder (see image 2.0). Select the "ArcGIS World Geocoding Service" and select "OK." For "Input Address Fields" change it from "Multiple Field" to "Single Field" and find the column "wholeAddress" in the "Single Line Input" box. For the country, check the box that says "United States" and ensure that "Preferred Location Type" is set to "Address location." When all is done the geocoding tool should be set up similar to what image 2.1 looks like.

![Image 2.0: Finding the Address Locator](https://raw.githubusercontent.com/Duceman56/2019MappingOfGunArchive/main/pictures/image2%2C0FindingLocator.JPG)

![Image 2.1: Final Setup of Geocoding Tool](https://raw.githubusercontent.com/Duceman56/2019MappingOfGunArchive/main/pictures/iamge2%2C1GeocodingTool.JPG)

With a new layer in the "Contents" pane of the geocoded addresses, graduate colors was chosen for the symbology of how the data will be classified and mapped. Final results for the maps will be shown in the "Results" section of this report.

Within this map, the States themselves will also be color coded to portray a states legal status 

## Results
The maps produced include four total maps

## summary statistics
```{r}
sum(handgun$`# Killed`)
sum(handgun$`# Injured`)
str(handgun)
(sum(handgun$`# Killed`)/8035)
(sum(handgun$`# Injured`)/8035)

sum(rifle$`# Killed`)
sum(rifle$`# Injured`)
str(rifle)
(sum(rifle$`# Killed`)/1697)
(sum(rifle$`# Injured`)/1697)

sum(shotgun$`# Victims Killed`)
sum(shotgun$`# Victims Injured`)
str(shotgun)
(sum(shotgun$`# Victims Killed`)/1038)
(sum(shotgun$`# Victims Injured`)/1038)
```

![this is captions](https://raw.githubusercontent.com/Duceman56/2019MappingOfGunArchive/main/pictures/handgunDeathsInUsa2019.png)

![this is captions](https://raw.githubusercontent.com/Duceman56/2019MappingOfGunArchive/main/pictures/rifleDeathsInUsa2019.png)

![this is captions](https://raw.githubusercontent.com/Duceman56/2019MappingOfGunArchive/main/pictures/shotgunDeathsInUsa2019.png)


## Conclusion

## References
"District of Columbia v. Heller." Oyez. Accessed May 12, 2023. https://www.oyez.org/cases/2007/07-290.

“Gun Violence Archive.” Gun Violence Archive, January 1, 2022. https://www.gunviolencearchive.org/explainer. 

R Core Team (2023). R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria. URL https://www.R-project.org/.

Short answers against Gun Control &amp; how to defend the 2nd Amendment. Critical Mas EP47. YouTube. Wilson Combat, 2022. https://www.youtube.com/watch?v=pHRZhS8GTc0&amp;t=589s&amp;ab_channel=WilsonCombat. 

Willingham, AJ. “27 Words: Deconstructing the Second Amendment.” CNN, March 28, 2018. https://www.cnn.com/2016/08/10/politics/what-does-the-second-amendment-actually-mean-trnd/index.html. 

